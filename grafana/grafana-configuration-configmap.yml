apiVersion: v1
kind: ConfigMap
metadata:
  labels:
    app: grafana
  name: grafana-dashs
  namespace: grafana
data:
  dashboard.json: |+
    {
    "annotations":{
        "list":[
            {
                "builtIn":1,
                "datasource":"-- Grafana --",
                "enable":true,
                "hide":true,
                "iconColor":"rgba(0, 211, 255, 1)",
                "name":"Annotations & Alerts",
                "type":"dashboard"
            }
        ]
    },
    "description":"Dashboard to show CIS compliance and vulnerabilities for a cluster",
    "editable":true,
    "gnetId":null,
    "graphTooltip":0,
    "id":1,
    "iteration":1620111924135,
    "links":[
        
    ],
    "panels":[
        {
            "cacheTimeout":null,
            "datasource":"$datasource",
            "description":"Percentage calculation of Passed CIS scored of total scored ",
            "fieldConfig":{
                "defaults":{
                    "mappings":[
                        {
                            "id":0,
                            "op":"=",
                            "text":"N/A",
                            "type":1,
                            "value":"null"
                        }
                    ],
                    "thresholds":{
                        "mode":"percentage",
                        "steps":[
                            {
                                "color":"rgb(217, 35, 54)",
                                "value":null
                            },
                            {
                                "color":"rgb(245, 151, 57)",
                                "value":20
                            },
                            {
                                "color":"rgb(59, 153, 46)",
                                "value":50
                            }
                        ]
                    },
                    "unit":"percentunit"
                },
                "overrides":[
                    
                ]
            },
            "gridPos":{
                "h":6,
                "w":9,
                "x":0,
                "y":0
            },
            "id":12,
            "interval":null,
            "links":[
                
            ],
            "maxDataPoints":100,
            "options":{
                "orientation":"auto",
                "reduceOptions":{
                    "calcs":[
                        "mean"
                    ],
                    "fields":"",
                    "values":false
                },
                "showThresholdLabels":false,
                "showThresholdMarkers":true,
                "text":{
                    
                }
            },
            "pluginVersion":"7.5.0-pre",
            "targets":[
                {
                    "exemplar":true,
                    "expr":"count(cis_results{cluster=~\"$cluster\",hostname=~\"$hostname\",scored=\"true\",status=\"PASS\"})/count(cis_results{cluster=~\"$cluster\",hostname=~\"$hostname\",scored=\"true\"})",
                    "format":"time_series",
                    "instant":true,
                    "interval":"",
                    "intervalFactor":1,
                    "legendFormat":"Checks Passed",
                    "refId":"A"
                }
            ],
            "timeFrom":null,
            "timeShift":null,
            "title":"CIS Scored Passed",
            "type":"gauge"
        },
        {
            "cacheTimeout":null,
            "datasource":"$datasource",
            "description":"",
            "fieldConfig":{
                "defaults":{
                    "mappings":[
                        {
                            "id":0,
                            "op":"=",
                            "text":"N/A",
                            "type":1,
                            "value":"null"
                        }
                    ],
                    "thresholds":{
                        "mode":"percentage",
                        "steps":[
                            {
                                "color":"rgb(217, 35, 54)",
                                "value":null
                            },
                            {
                                "color":"rgb(245, 151, 57)",
                                "value":20
                            },
                            {
                                "color":"rgb(59, 153, 46)",
                                "value":50
                            }
                        ]
                    },
                    "unit":"percentunit"
                },
                "overrides":[
                    
                ]
            },
            "gridPos":{
                "h":6,
                "w":9,
                "x":9,
                "y":0
            },
            "id":21,
            "interval":null,
            "links":[
                
            ],
            "maxDataPoints":100,
            "options":{
                "orientation":"auto",
                "reduceOptions":{
                    "calcs":[
                        "mean"
                    ],
                    "fields":"",
                    "values":false
                },
                "showThresholdLabels":false,
                "showThresholdMarkers":true,
                "text":{
                    
                }
            },
            "pluginVersion":"7.5.0-pre",
            "targets":[
                {
                    "exemplar":true,
                    "expr":"count(cis_results{cluster=~\"$cluster\",hostname=~\"$hostname\",status=\"PASS\"})/count(cis_results{cluster=~\"$cluster\",hostname=~\"$hostname\"})",
                    "format":"time_series",
                    "instant":true,
                    "interval":"",
                    "intervalFactor":1,
                    "legendFormat":"Checks Passed",
                    "refId":"A"
                }
            ],
            "timeFrom":null,
            "timeShift":null,
            "title":"Best Practices Checks",
            "type":"gauge"
        },
        {
            "aliasColors":{
                
            },
            "bars":true,
            "cacheTimeout":null,
            "dashLength":10,
            "dashes":false,
            "datasource":"$datasource",
            "description":"",
            "fieldConfig":{
                "defaults":{
                    
                },
                "overrides":[
                    
                ]
            },
            "fill":1,
            "fillGradient":0,
            "gridPos":{
                "h":9,
                "w":6,
                "x":18,
                "y":0
            },
            "hiddenSeries":false,
            "id":20,
            "interval":null,
            "legend":{
                "avg":false,
                "current":false,
                "max":false,
                "min":false,
                "show":false,
                "total":false,
                "values":false
            },
            "lines":false,
            "linewidth":1,
            "links":[
                
            ],
            "maxDataPoints":100,
            "nullPointMode":"null",
            "options":{
                "alertThreshold":true
            },
            "percentage":false,
            "pluginVersion":"7.5.0-pre",
            "pointradius":2,
            "points":false,
            "renderer":"flot",
            "seriesOverrides":[
                {
                    "$$hashKey":"object:124",
                    "alias":"Low",
                    "color":"#FFEE52"
                }
            ],
            "spaceLength":10,
            "stack":false,
            "steppedLine":false,
            "targets":[
                {
                    "exemplar":true,
                    "expr":"count(kube_hunter_metrics_info{severity=\"low\"})",
                    "format":"time_series",
                    "instant":true,
                    "interval":"",
                    "intervalFactor":1,
                    "legendFormat":"Low",
                    "refId":"A"
                },
                {
                    "exemplar":true,
                    "expr":"count(kube_hunter_metrics_info{severity=\"medium\"})",
                    "format":"time_series",
                    "hide":false,
                    "instant":true,
                    "interval":"",
                    "intervalFactor":1,
                    "legendFormat":"Medium",
                    "refId":"B"
                },
                {
                    "exemplar":true,
                    "expr":"count(kube_hunter_metrics_info{severity=\"critical\"})",
                    "format":"time_series",
                    "hide":false,
                    "instant":true,
                    "interval":"",
                    "intervalFactor":1,
                    "legendFormat":"Critical",
                    "refId":"C"
                }
            ],
            "thresholds":[
                
            ],
            "timeFrom":null,
            "timeRegions":[
                {
                    "$$hashKey":"object:94",
                    "colorMode":"background6",
                    "fill":true,
                    "fillColor":"rgba(234, 112, 112, 0.12)",
                    "line":false,
                    "lineColor":"rgba(237, 46, 24, 0.60)",
                    "op":"time"
                }
            ],
            "timeShift":null,
            "title":"Severity Checks",
            "tooltip":{
                "shared":false,
                "sort":0,
                "value_type":"individual"
            },
            "type":"graph",
            "xaxis":{
                "buckets":null,
                "mode":"series",
                "name":null,
                "show":true,
                "values":[
                    "total"
                ]
            },
            "yaxes":[
                {
                    "$$hashKey":"object:66",
                    "format":"short",
                    "label":null,
                    "logBase":1,
                    "max":null,
                    "min":null,
                    "show":true
                },
                {
                    "$$hashKey":"object:67",
                    "format":"short",
                    "label":null,
                    "logBase":1,
                    "max":null,
                    "min":null,
                    "show":true
                }
            ],
            "yaxis":{
                "align":false,
                "alignLevel":null
            }
        },
        {
            "cacheTimeout":null,
            "datasource":"$datasource",
            "description":"Total CIS checks performed on account ",
            "fieldConfig":{
                "defaults":{
                    "mappings":[
                        {
                            "id":0,
                            "op":"=",
                            "text":"N/A",
                            "type":1,
                            "value":"null"
                        }
                    ],
                    "thresholds":{
                        "mode":"absolute",
                        "steps":[
                            {
                                "color":"green",
                                "value":null
                            }
                        ]
                    },
                    "unit":"none"
                },
                "overrides":[
                    
                ]
            },
            "gridPos":{
                "h":3,
                "w":3,
                "x":0,
                "y":6
            },
            "id":8,
            "interval":null,
            "links":[
                
            ],
            "maxDataPoints":100,
            "options":{
                "colorMode":"value",
                "fieldOptions":{
                    "calcs":[
                        "mean"
                    ]
                },
                "graphMode":"area",
                "justifyMode":"auto",
                "orientation":"horizontal",
                "reduceOptions":{
                    "calcs":[
                        "mean"
                    ],
                    "fields":"",
                    "values":false
                },
                "text":{
                    "valueSize":50
                },
                "textMode":"auto"
            },
            "pluginVersion":"7.5.0-pre",
            "repeatDirection":"h",
            "targets":[
                {
                    "exemplar":true,
                    "expr":"count(cis_results{cluster=~\"$cluster\",hostname=~\"$hostname\"})",
                    "format":"time_series",
                    "instant":true,
                    "interval":"1h",
                    "intervalFactor":1,
                    "legendFormat":"",
                    "refId":"A"
                }
            ],
            "title":"Total Checks",
            "type":"stat"
        },
        {
            "cacheTimeout":null,
            "datasource":"$datasource",
            "description":"Failure to comply with \"Scored\" recommendations will decrease the final benchmark score. Compliance with \"Scored\" recommendations will increase the final benchmark score.",
            "fieldConfig":{
                "defaults":{
                    "mappings":[
                        {
                            "id":0,
                            "op":"=",
                            "text":"N/A",
                            "type":1,
                            "value":"null"
                        }
                    ],
                    "thresholds":{
                        "mode":"absolute",
                        "steps":[
                            {
                                "color":"orange",
                                "value":null
                            }
                        ]
                    },
                    "unit":"none"
                },
                "overrides":[
                    
                ]
            },
            "gridPos":{
                "h":3,
                "w":3,
                "x":3,
                "y":6
            },
            "id":18,
            "interval":null,
            "links":[
                
            ],
            "maxDataPoints":100,
            "options":{
                "colorMode":"value",
                "fieldOptions":{
                    "calcs":[
                        "mean"
                    ]
                },
                "graphMode":"area",
                "justifyMode":"auto",
                "orientation":"horizontal",
                "reduceOptions":{
                    "calcs":[
                        "mean"
                    ],
                    "fields":"",
                    "values":false
                },
                "text":{
                    "valueSize":50
                },
                "textMode":"auto"
            },
            "pluginVersion":"7.5.0-pre",
            "repeatDirection":"h",
            "targets":[
                {
                    "exemplar":true,
                    "expr":"count(cis_results{cluster=~\"$cluster\",hostname=~\"$hostname\",scored=\"true\"})",
                    "format":"time_series",
                    "instant":true,
                    "interval":"1h",
                    "intervalFactor":1,
                    "legendFormat":"",
                    "refId":"A"
                }
            ],
            "title":"Scored",
            "type":"stat"
        },
        {
            "cacheTimeout":null,
            "datasource":"$datasource",
            "description":"Failure to comply with \"Not Scored\" recommendations will not decrease the final \nbenchmark score. Compliance with \"Not Scored\" recommendations will not increase the final benchmark score",
            "fieldConfig":{
                "defaults":{
                    "mappings":[
                        {
                            "id":0,
                            "op":"=",
                            "text":"N/A",
                            "type":1,
                            "value":"null"
                        }
                    ],
                    "thresholds":{
                        "mode":"absolute",
                        "steps":[
                            {
                                "color":"yellow",
                                "value":null
                            }
                        ]
                    },
                    "unit":"none"
                },
                "overrides":[
                    
                ]
            },
            "gridPos":{
                "h":3,
                "w":3,
                "x":6,
                "y":6
            },
            "id":19,
            "interval":null,
            "links":[
                
            ],
            "maxDataPoints":100,
            "options":{
                "colorMode":"value",
                "fieldOptions":{
                    "calcs":[
                        "mean"
                    ]
                },
                "graphMode":"area",
                "justifyMode":"auto",
                "orientation":"horizontal",
                "reduceOptions":{
                    "calcs":[
                        "mean"
                    ],
                    "fields":"",
                    "values":false
                },
                "text":{
                    "valueSize":50
                },
                "textMode":"auto"
            },
            "pluginVersion":"7.5.0-pre",
            "repeatDirection":"h",
            "targets":[
                {
                    "exemplar":true,
                    "expr":"count(cis_results{cluster=~\"$cluster\",hostname=~\"$hostname\",scored=\"false\"})",
                    "format":"time_series",
                    "instant":true,
                    "interval":"1h",
                    "intervalFactor":1,
                    "legendFormat":"",
                    "refId":"A"
                }
            ],
            "title":"Not Scored",
            "type":"stat"
        },
        {
            "cacheTimeout":null,
            "datasource":"$datasource",
            "description":"The service complies with the benchmark recommendation",
            "fieldConfig":{
                "defaults":{
                    "mappings":[
                        {
                            "id":0,
                            "op":"=",
                            "text":"N/A",
                            "type":1,
                            "value":"null"
                        }
                    ],
                    "thresholds":{
                        "mode":"absolute",
                        "steps":[
                            {
                                "color":"green",
                                "value":null
                            }
                        ]
                    },
                    "unit":"none"
                },
                "overrides":[
                    
                ]
            },
            "gridPos":{
                "h":3,
                "w":3,
                "x":9,
                "y":6
            },
            "id":22,
            "interval":null,
            "links":[
                
            ],
            "maxDataPoints":100,
            "options":{
                "colorMode":"value",
                "fieldOptions":{
                    "calcs":[
                        "mean"
                    ]
                },
                "graphMode":"area",
                "justifyMode":"auto",
                "orientation":"horizontal",
                "reduceOptions":{
                    "calcs":[
                        "mean"
                    ],
                    "fields":"",
                    "values":false
                },
                "text":{
                    "valueSize":50
                },
                "textMode":"auto"
            },
            "pluginVersion":"7.5.0-pre",
            "repeatDirection":"h",
            "targets":[
                {
                    "exemplar":true,
                    "expr":"count(cis_results{cluster=~\"$cluster\",hostname=~\"$hostname\",status=\"PASS\"})",
                    "format":"time_series",
                    "instant":true,
                    "interval":"1h",
                    "intervalFactor":1,
                    "legendFormat":"",
                    "refId":"A"
                }
            ],
            "title":"Passed",
            "type":"stat"
        },
        {
            "cacheTimeout":null,
            "datasource":"$datasource",
            "description":"The service does not comply with the benchmark recommendation by default. Refer to the remediation section for an explanation and possible actions that you can take to comply with the benchmark recommendation",
            "fieldConfig":{
                "defaults":{
                    "mappings":[
                        {
                            "id":0,
                            "op":"=",
                            "text":"0",
                            "type":1,
                            "value":"null"
                        }
                    ],
                    "thresholds":{
                        "mode":"absolute",
                        "steps":[
                            {
                                "color":"rgb(217, 35, 54)",
                                "value":null
                            }
                        ]
                    },
                    "unit":"none"
                },
                "overrides":[
                    
                ]
            },
            "gridPos":{
                "h":3,
                "w":3,
                "x":12,
                "y":6
            },
            "id":25,
            "interval":null,
            "links":[
                
            ],
            "maxDataPoints":100,
            "options":{
                "colorMode":"value",
                "fieldOptions":{
                    "calcs":[
                        "mean"
                    ]
                },
                "graphMode":"area",
                "justifyMode":"auto",
                "orientation":"horizontal",
                "reduceOptions":{
                    "calcs":[
                        "mean"
                    ],
                    "fields":"",
                    "values":false
                },
                "text":{
                    "valueSize":50
                },
                "textMode":"auto"
            },
            "pluginVersion":"7.5.0-pre",
            "repeatDirection":"h",
            "targets":[
                {
                    "exemplar":true,
                    "expr":"count(cis_results{cluster=~\"$cluster\",hostname=~\"$hostname\",status=\"FAIL\"})",
                    "format":"time_series",
                    "instant":true,
                    "interval":"1h",
                    "intervalFactor":1,
                    "legendFormat":"",
                    "refId":"A"
                }
            ],
            "title":"Failed",
            "type":"stat"
        },
        {
            "cacheTimeout":null,
            "datasource":"$datasource",
            "description":"",
            "fieldConfig":{
                "defaults":{
                    "mappings":[
                        {
                            "id":0,
                            "op":"=",
                            "text":"0",
                            "type":1,
                            "value":"null"
                        }
                    ],
                    "thresholds":{
                        "mode":"absolute",
                        "steps":[
                            {
                                "color":"rgb(245, 151, 57)",
                                "value":null
                            }
                        ]
                    },
                    "unit":"none"
                },
                "overrides":[
                    
                ]
            },
            "gridPos":{
                "h":3,
                "w":3,
                "x":15,
                "y":6
            },
            "id":26,
            "interval":null,
            "links":[
                
            ],
            "maxDataPoints":100,
            "options":{
                "colorMode":"value",
                "fieldOptions":{
                    "calcs":[
                        "mean"
                    ]
                },
                "graphMode":"area",
                "justifyMode":"auto",
                "orientation":"horizontal",
                "reduceOptions":{
                    "calcs":[
                        "mean"
                    ],
                    "fields":"",
                    "values":false
                },
                "text":{
                    "valueSize":50
                },
                "textMode":"auto"
            },
            "pluginVersion":"7.5.0-pre",
            "repeatDirection":"h",
            "targets":[
                {
                    "exemplar":true,
                    "expr":"count(cis_results{cluster=~\"$cluster\",hostname=~\"$hostname\",status=\"WARN\"})",
                    "format":"time_series",
                    "instant":true,
                    "interval":"1h",
                    "intervalFactor":1,
                    "legendFormat":"",
                    "refId":"A"
                }
            ],
            "title":"Warning",
            "type":"stat"
        },
        {
            "datasource":"${datasource}",
            "fieldConfig":{
                "defaults":{
                    "custom":{
                        "align":"left",
                        "displayMode":"auto"
                    },
                    "mappings":[
                        
                    ],
                    "thresholds":{
                        "mode":"absolute",
                        "steps":[
                            {
                                "color":"green",
                                "value":null
                            },
                            {
                                "color":"red",
                                "value":80
                            }
                        ]
                    }
                },
                "overrides":[
                    {
                        "matcher":{
                            "id":"byName",
                            "options":"Pod"
                        },
                        "properties":[
                            {
                                "id":"custom.width",
                                "value":163
                            },
                            {
                                "id":"custom.filterable",
                                "value":true
                            }
                        ]
                    },
                    {
                        "matcher":{
                            "id":"byName",
                            "options":"Namespace"
                        },
                        "properties":[
                            {
                                "id":"custom.width",
                                "value":127
                            },
                            {
                                "id":"custom.filterable",
                                "value":true
                            }
                        ]
                    },
                    {
                        "matcher":{
                            "id":"byName",
                            "options":"Scored"
                        },
                        "properties":[
                            {
                                "id":"custom.width",
                                "value":92
                            },
                            {
                                "id":"custom.filterable",
                                "value":true
                            }
                        ]
                    },
                    {
                        "matcher":{
                            "id":"byName",
                            "options":"Status"
                        },
                        "properties":[
                            {
                                "id":"custom.width",
                                "value":90
                            },
                            {
                                "id":"custom.filterable",
                                "value":true
                            }
                        ]
                    },
                    {
                        "matcher":{
                            "id":"byName",
                            "options":"Type"
                        },
                        "properties":[
                            {
                                "id":"custom.width",
                                "value":224
                            },
                            {
                                "id":"custom.filterable",
                                "value":true
                            }
                        ]
                    },
                    {
                        "matcher":{
                            "id":"byName",
                            "options":"Instance"
                        },
                        "properties":[
                            {
                                "id":"custom.filterable",
                                "value":true
                            }
                        ]
                    },
                    {
                        "matcher":{
                            "id":"byName",
                            "options":"Check Detail"
                        },
                        "properties":[
                            {
                                "id":"custom.width",
                                "value":225
                            }
                        ]
                    },
                    {
                        "matcher":{
                            "id":"byName",
                            "options":"Actual Value"
                        },
                        "properties":[
                            {
                                "id":"custom.width",
                                "value":0
                            }
                        ]
                    },
                    {
                        "matcher":{
                            "id":"byName",
                            "options":"Expected Value"
                        },
                        "properties":[
                            {
                                "id":"custom.width",
                                "value":187
                            }
                        ]
                    },
                    {
                        "matcher":{
                            "id":"byName",
                            "options":"Remediation"
                        },
                        "properties":[
                            {
                                "id":"custom.width",
                                "value":298
                            }
                        ]
                    }
                ]
            },
            "gridPos":{
                "h":14,
                "w":24,
                "x":0,
                "y":9
            },
            "id":2,
            "links":[
                
            ],
            "options":{
                "showHeader":true,
                "sortBy":[
                    
                ]
            },
            "pluginVersion":"7.5.0-pre",
            "targets":[
                {
                    "exemplar":true,
                    "expr":"cis_results{cluster=~\"$cluster\",hostname=~\"$hostname\"}",
                    "format":"table",
                    "instant":true,
                    "interval":"",
                    "intervalFactor":1,
                    "legendFormat":"",
                    "refId":"A"
                }
            ],
            "title":"Detailed CIS Assessment Report",
            "transformations":[
                {
                    "id":"filterFieldsByName",
                    "options":{
                        "include":{
                            "names":[
                                "actual_value",
                                "expected_result",
                                "pod",
                                "remediation",
                                "scored",
                                "status",
                                "test_desc"
                            ]
                        }
                    }
                },
                {
                    "id":"organize",
                    "options":{
                        "excludeByName":{
                            
                        },
                        "indexByName":{
                            "actual_value":6,
                            "expected_result":5,
                            "namespace":2,
                            "pod":1,
                            "remediation":7,
                            "scored":3,
                            "status":4,
                            "test_desc":0
                        },
                        "renameByName":{
                            "actual_value":"Actual Value",
                            "expected_result":"Expected Value",
                            "hostname":"Hostname",
                            "instance":"Instance",
                            "namespace":"Namespace",
                            "pod":"Pod",
                            "remediation":"Remediation",
                            "scored":"Scored",
                            "status":"Status",
                            "test_desc":"Check Detail",
                            "type":"Type"
                        }
                    }
                }
            ],
            "type":"table"
        },
        {
            "datasource":"$datasource",
            "fieldConfig":{
                "defaults":{
                    "custom":{
                        "align":null,
                        "displayMode":"auto"
                    },
                    "mappings":[
                        
                    ],
                    "thresholds":{
                        "mode":"absolute",
                        "steps":[
                            {
                                "color":"green",
                                "value":null
                            },
                            {
                                "color":"red",
                                "value":80
                            }
                        ]
                    }
                },
                "overrides":[
                    {
                        "matcher":{
                            "id":"byName",
                            "options":"Pod"
                        },
                        "properties":[
                            {
                                "id":"custom.width",
                                "value":202
                            },
                            {
                                "id":"custom.filterable",
                                "value":true
                            }
                        ]
                    },
                    {
                        "matcher":{
                            "id":"byName",
                            "options":"Severity"
                        },
                        "properties":[
                            {
                                "id":"custom.width",
                                "value":99
                            },
                            {
                                "id":"custom.filterable",
                                "value":true
                            }
                        ]
                    },
                    {
                        "matcher":{
                            "id":"byName",
                            "options":"Category"
                        },
                        "properties":[
                            {
                                "id":"custom.width",
                                "value":124
                            },
                            {
                                "id":"custom.filterable",
                                "value":true
                            }
                        ]
                    },
                    {
                        "matcher":{
                            "id":"byName",
                            "options":"Vulnerability"
                        },
                        "properties":[
                            {
                                "id":"custom.width",
                                "value":186
                            },
                            {
                                "id":"custom.filterable",
                                "value":true
                            }
                        ]
                    },
                    {
                        "matcher":{
                            "id":"byName",
                            "options":"Instance"
                        },
                        "properties":[
                            {
                                "id":"custom.filterable",
                                "value":true
                            },
                            {
                                "id":"custom.width",
                                "value":144
                            }
                        ]
                    }
                ]
            },
            "gridPos":{
                "h":5,
                "w":24,
                "x":0,
                "y":23
            },
            "id":16,
            "links":[
                
            ],
            "options":{
                "showHeader":true,
                "sortBy":[
                    
                ]
            },
            "pluginVersion":"7.5.0-pre",
            "targets":[
                {
                    "exemplar":true,
                    "expr":"kube_hunter_metrics_info{}",
                    "format":"table",
                    "instant":true,
                    "interval":"",
                    "intervalFactor":1,
                    "legendFormat":"",
                    "refId":"A"
                }
            ],
            "title":"Detailed Vulnerabilities Assessment Report",
            "transformations":[
                {
                    "id":"filterFieldsByName",
                    "options":{
                        "include":{
                            "names":[
                                "category",
                                "description",
                                "pod",
                                "severity",
                                "vulnerability",
                                "instance"
                            ]
                        }
                    }
                },
                {
                    "id":"organize",
                    "options":{
                        "excludeByName":{
                            
                        },
                        "indexByName":{
                            "category":3,
                            "description":5,
                            "instance":1,
                            "pod":0,
                            "severity":2,
                            "vulnerability":4
                        },
                        "renameByName":{
                            "category":"Category",
                            "description":"Description",
                            "instance":"Instance",
                            "pod":"Pod",
                            "severity":"Severity",
                            "vulnerability":"Vulnerability"
                        }
                    }
                }
            ],
            "type":"table"
        }
    ],
    "refresh":"1m",
    "schemaVersion":27,
    "style":"dark",
    "tags":[
        
    ],
    "templating":{
        "list":[
            {
                "current":{
                    "selected":false,
                    "text":"Prometheus",
                    "value":"Prometheus"
                },
                "description":null,
                "error":null,
                "hide":0,
                "includeAll":false,
                "label":null,
                "multi":false,
                "name":"datasource",
                "options":[
                    
                ],
                "query":"prometheus",
                "queryValue":"",
                "refresh":1,
                "regex":"",
                "skipUrlSync":false,
                "type":"datasource"
            },
            {
                "allValue":"",
                "current":{
                    "selected":true,
                    "text":[
                        "All"
                    ],
                    "value":[
                        "$__all"
                    ]
                },
                "datasource":"$datasource",
                "definition":"label_values(cis_results,cluster)",
                "description":null,
                "error":null,
                "hide":0,
                "includeAll":true,
                "label":"",
                "multi":true,
                "name":"cluster",
                "options":[
                    
                ],
                "query":{
                    "query":"label_values(cis_results,cluster)",
                    "refId":"Prometheus-cluster-Variable-Query"
                },
                "refresh":2,
                "regex":"",
                "skipUrlSync":false,
                "sort":0,
                "tagValuesQuery":"",
                "tags":[
                    
                ],
                "tagsQuery":"",
                "type":"query",
                "useTags":false
            },
            {
                "allValue":"",
                "current":{
                    "selected":true,
                    "text":[
                        "All"
                    ],
                    "value":[
                        "$__all"
                    ]
                },
                "datasource":"$datasource",
                "definition":"label_values(cis_results,hostname)",
                "description":null,
                "error":null,
                "hide":0,
                "includeAll":true,
                "label":"hostname",
                "multi":true,
                "name":"hostname",
                "options":[
                    
                ],
                "query":{
                    "query":"label_values(cis_results,hostname)",
                    "refId":"Prometheus-hostname-Variable-Query"
                },
                "refresh":2,
                "regex":"",
                "skipUrlSync":false,
                "sort":0,
                "tagValuesQuery":"",
                "tags":[
                    
                ],
                "tagsQuery":"",
                "type":"query",
                "useTags":false
            }
        ]
    },
    "time":{
        "from":"now-1h",
        "to":"now"
    },
    "timepicker":{
        "refresh_intervals":[
            "10s",
            "30s",
            "1m",
            "5m",
            "15m",
            "30m",
            "1h",
            "2h",
            "1d"
        ],
        "time_options":[
            "5m",
            "15m",
            "1h",
            "6h",
            "12h",
            "24h",
            "2d",
            "7d",
            "30d"
        ]
    },
    "timezone":"",
    "title":"CitiusTech Kubernetes CoE Dashboard",
    "uid":"nM0YqnhWz",
    "version":28
    }
---
apiVersion: v1
kind: ConfigMap
metadata:
  labels:
    app: grafana
  name: grafana-dash-provider
  namespace: grafana
data:
  providers.yaml: |
    apiVersion: 1
    providers:
    - name: 'default'
      orgId: 1
      folder: ''
      type: file
      disableDeletion: false
      editable: false
      options:
        path: /var/lib/grafana/dashboards
---
apiVersion: v1
kind: ConfigMap
metadata:
  labels:
    app: grafana
  name: grafana-datasources-provider
  namespace: grafana
data:
  providers.yaml: |
    apiVersion: 1
    datasources:
    - name: 'prometheus'
      type: prometheus
      access: server
      orgId: 1
      url: http://prometheus-stack-kube-prom-prometheus:9090
      isDefault: true
      editable: false